const products = [
    {
        id: 1,
        size: "S",
        color: "Black",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_black.png",
    },
    {
        id: 2,
        size: "M",
        color: "Black",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_black.png",
    },
    {
        id: 3,
        size: "L",
        color: "Black",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_black.png",
    },
    {
        id: 4,
        size: "XL",
        color: "Black",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_black.png",
    },
    {
        id: 5,
        size: "S",
        color: "Blue",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_blue.png",
    },
    {
        id: 6,
        size: "M",
        color: "Blue",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_blue.png",
    },
    {
        id: 7,
        size: "L",
        color: "Blue",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_blue.png",
    },
    {
        id: 8,
        size: "S",
        color: "Olive",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_olive.png",
    },
    {
        id: 9,
        size: "M",
        color: "Olive",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_olive.png",
    },
    {
        id: 10,
        size: "L",
        color: "Olive",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_olive.png",
    },
    {
        id: 11,
        size: "XL",
        color: "Olive",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_olive.png",
    },
    {
        id: 12,
        size: "S",
        color: "Red",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_red.png",
    },
    {
        id: 13,
        size: "M",
        color: "Red",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_red.png",
    },
    {
        id: 14,
        size: "L",
        color: "Red",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_red.png",
    },
    {
        id: 15,
        size: "XL",
        color: "Red",
        type: "T-shirt",
        url: "../../resources/img/merch/Tshirt/t-shirt_red.png",
    },
    {
        id: 17,
        size: "S",
        color: "Black",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/black-hoodie.jpg",
    },
    {
        id: 18,
        size: "M",
        color: "Black",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/black-hoodie.jpg",
    },
    {
        id: 19,
        size: "L",
        color: "Black",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/black-hoodie.jpg",
    },
    {
        id: 20,
        size: "XL",
        color: "Black",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/black-hoodie.jpg",
    },
    {
        id: 21,
        size: "S",
        color: "Blue",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/blue-hoodie.jpg",
    },
    {
        id: 22,
        size: "M",
        color: "Blue",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/blue-hoodie.jpg",
    },
    {
        id: 23,
        size: "L",
        color: "Blue",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/blue-hoodie.jpg",
    },
    {
        id: 24,
        size: "XL",
        color: "Blue",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/blue-hoodie.jpg",
    },
    {
        id: 25,
        size: "S",
        color: "Red",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/red-hoodie.jpg",
    },
    {
        id: 26,
        size: "M",
        color: "Red",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/red-hoodie.jpg",
    },
    {
        id: 27,
        size: "L",
        color: "Red",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/red-hoodie.jpg",
    },
    {
        id: 28,
        size: "XL",
        color: "Red",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/red-hoodie.jpg",
    },
    {
        id: 29,
        size: "S",
        color: "Olive",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/olive-hoodie.jpg",
    },
    {
        id: 30,
        size: "M",
        color: "Olive",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/olive-hoodie.jpg",
    },
    {
        id: 31,
        size: "L",
        color: "Olive",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/olive-hoodie.jpg",
    },
    {
        id: 32,
        size: "XL",
        color: "Olive",
        type: "Hoodie",
        url: "../../resources/img/merch/hoodie/olive-hoodie.jpg",
    },
    {
        id: 33,
        size: "one-size",
        color: "Olive",
        type: "Cap",
        url: "../../resources/img/merch/cap/olive-cap.jpg",
    },
    {
        id: 34,
        size: "one-size",
        color: "Black",
        type: "Cap",
        url: "../../resources/img/merch/cap/black-cap.jpg",
    },
    {
        id: 35,
        size: "one-size",
        color: "Red",
        type: "Cap",
        url: "../../resources/img/merch/cap/red-cap.jpg",
    },
];

document.addEventListener("DOMContentLoaded", function () {
    // create the thumbnail gallery from the whole product array of objects

    let displayThumbnails = (productsArray) => {
        const displayProductsThumbnails = document.getElementById(
            "display-products-thumbnails"
        );
        displayProductsThumbnails.innerHTML = "";
        productsArray.forEach(function (product) {
            const thumbnail = document.createElement("div");
            thumbnail.id = "thumbnail";

            thumbnail.innerHTML = `
            <img src="${product.url}" alt="${product.color} ${product.type}"/>
            <p>size: ${product.size}</p>
            `;
            displayProductsThumbnails.appendChild(thumbnail);
        });
    };

    displayThumbnails(products);

    // define filtering function returning an filtered array of products
    let productsFiltered = (value) => {
        // Check if the value is present in the object
        if (products.some((item) => Object.values(item).includes(`${value}`))) {
            return products.filter((item) =>
                Object.values(item).includes(`${value}`)
            );
        } else {
            console.log(
                "Property or value does not exist. Product does not exist."
            );
            return [];
        }
    };

    //define sorting function returning a sorted array of products
    let productsSorted = (property) => {
        if (property === "color") {
            return products.toSorted((a, b) => a.color.localeCompare(b.color));
        } else if (property === "size") {
            const sizeOrder = ["S", "M", "L", "XL"];
            const compareBySize = (a, b) => {
                const sizeA = sizeOrder.indexOf(a.size);
                const sizeB = sizeOrder.indexOf(b.size);
                return sizeA - sizeB;
            };
            return products.toSorted(compareBySize);
        }
    };

    // Add event handlers to dropdown menu options to apply filtering and sorting:
    // Filter by color:
    document.getElementById("color-select").addEventListener("change", (e) => {
        const colorSelected = e.target.value;
        let filteredByColor = productsFiltered(colorSelected);
        console.log(filteredByColor);
        displayThumbnails(filteredByColor);
    });

    // Filter by size:
    document.getElementById("size-select").addEventListener("change", (e) => {
        const sizeSelected = e.target.value;
        let filteredBySize = productsFiltered(sizeSelected);
        console.log(filteredBySize);
        displayThumbnails(filteredBySize);
    });

    // Filter by type:
    document.getElementById("type-select").addEventListener("change", (e) => {
        const typeSelected = e.target.value;
        let filteredByType = productsFiltered(typeSelected);
        console.log(filteredByType);
        displayThumbnails(filteredByType);
    });

    // Sort products
    document.getElementById("sort-select").addEventListener("change", (e) => {
        const sortValue = e.target.value;
        let sortedByValue = productsSorted(sortValue);
        displayThumbnails(sortedByValue);
    });

    // Add product properties to productCart object
    let productCart = {};

    console.log("Product cart object on page load", productCart);
    let productType = "The Product";

    let size = "small";
    document.getElementById("product-size").addEventListener("change", (e) => {
        size = e.target.value;
        productCart.size = size;
        return size;
    });

    let color = "blue";
    document.getElementById("product-color").addEventListener("change", (e) => {
        color = e.target.value;
        productCart.color = color;
        return color;
    });

    let quantity = 1;
    document
        .getElementById("product-quantity")
        .addEventListener("change", (e) => {
            quantity = e.target.value;
            productCart.quantity = quantity;
            return quantity;
        });

    productCart = {
        size: `${size}`,
        color: `${color}`,
        quantity: `${quantity}`,
    };

    // Add items to cart
    const addButton = document.getElementById("add-item");
    addButton.addEventListener("click", () => {
        let productStringified = JSON.stringify(productCart);
        localStorage.setItem("productCartSaved", productStringified);
    });

    // if localStorage.productBasket in not Empty render the basket icon with number of products
    let cartNumber = () => {
        if (document.getElementById("shopping-cart").classList === "hidden") {
            document.getElementById("shopping-cart").classList.remove("hidden");
        } else {
            document.getElementById("shopping-cart").classList.add("hidden");
        }
    };

    if (localStorage.productCartSaved) {
        // render the basket icon
        // document.getElementById("shopping-cart").classList.remove("hidden");
        cartNumber();
        let cartQuantity = document.getElementById("cart-quantity");
        let parsedStoreData = JSON.parse(localStorage.productCartSaved);
        cartQuantity.innerHTML = `${parsedStoreData.quantity}`;
        console.log("storage is not empty");
    } else console.log("storage is empty");

    // Remove Items from basket
    const removeButton = document.getElementById("remove-item");
    removeButton.addEventListener("click", () => {
        if (localStorage.productCartSaved) {
            localStorage.removeItem("productCartSaved");
            // document.getElementById("shopping-cart").classList.add("hidden");
            cartNumber();
        }
    });
});
